<div class="details-container">
  <div *ngIf="socket">
    <mat-list>
      <mat-list-item>Lab: <strong> &nbsp;{{socket.labName}}</strong></mat-list-item>
      <mat-divider></mat-divider>
      <mat-list-item>Table: <strong> &nbsp;{{socket.tableName}}</strong></mat-list-item>
      <mat-divider></mat-divider>
      <mat-list-item>Slot: <strong> &nbsp;{{socket.coord}}</strong></mat-list-item>
      <mat-divider></mat-divider>
      <ng-container *ngIf="socket && socketUser && socket.socket">
        <mat-list-item>
          Current Owner: <strong> &nbsp; {{socketUser.name}}</strong>
        </mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>
      <ng-container
        *ngIf="socket != undefined && socketUser != undefined && socket.socket != undefined && (out == false || out == undefined)">
        <mat-list-item>
          Socket Checkout
          Date: <strong> &nbsp;{{socket.socket.checkOutTime | date}}</strong></mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>
      <ng-container *ngIf="out == true">
        <mat-list-item>Socket Checkout Date: </mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>
      <ng-container *ngIf="socket != undefined && this.socket.socket != undefined">
        <mat-list-item>Socket Form:
          <strong> &nbsp;{{socket.socket.form}}</strong>
        </mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>
      <ng-container *ngIf="socket != undefined && this.socket.socket != undefined">
        <mat-list-item>Socket Voltage:
          <strong> &nbsp;{{socket.socket.voltage}}</strong>
        </mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>
    </mat-list>
  </div>
  <form *ngIf="socket != undefined && this.socket.socket != undefined; else noSocket" (ngSubmit)="onSubmit()"
    [formGroup]="detailsForm">
    <mat-form-field class="item-align">
      <input type="text" matInput placeholder="Meter LAN ID" name="Meter LAN ID" aria-label="Meter LAN ID"
        aria-describedby="Meter LAN ID Input" formControlName="meterLanId">
      <mat-error *ngIf="detailsForm.get('meterLanId')?.errors?.['pattern']">Must enter hex value</mat-error>
      <mat-error
        *ngIf="detailsForm.get('meterLanId')?.errors?.['maxlength'] || detailsForm.get('meterLanId')?.errors?.['minlength']">
        Must be 8 characters in length</mat-error>
    </mat-form-field>
    <mat-form-field class="item-align">
      <input type="text" matInput placeholder="Expected Checkout Duration (days)"
        name="Expected Checkout Duration (days)" aria-label="Expected Checkout Duration (days)"
        aria-describedby="Expected Checkout Duration (days)" formControlName="duration">
      <mat-error
        *ngIf="detailsForm.get('duration')?.errors?.['pattern'] || detailsForm.get('duration')?.errors?.['min']">Must
        enter positive integer</mat-error>
      <mat-error *ngIf="detailsForm.get('duration')?.errors?.['required']">Field is required</mat-error>
      <mat-error *ngIf="detailsForm.get('duration')?.errors?.['max']">Must be less than or equal to 180</mat-error>
    </mat-form-field>
    <mat-form-field class="item-align">
      <textarea type="text" matInput placeholder="Comment" name="Comment" aria-label="Comment"
        aria-describedby="Comment Input" formControlName="comment"></textarea>
      <mat-error *ngIf="detailsForm.get('comment')?.errors?.['maxlength']">Must have 100 characters or less
      </mat-error>
    </mat-form-field>
    <div class="verticalPadding"></div>
    <div class="item-align" *ngIf="socket">
      <div *ngIf="out == false">
        <button [disabled]="disableCheck" type="submit" class="btn btn-primary">Check-in</button>
      </div>
      <div *ngIf="out == true">
        <button [disabled]="!detailsForm.valid || disableCheck" type="submit" class="btn btn-primary">Checkout</button>
        <mat-error *ngIf="meterUseError">{{errorMeterUser ? loginUser.id == errorMeterUser.id ? sameUserText :
          errorMeterUser.name + useText : 'An unknown user' + useText}}</mat-error>
        <mat-error *ngIf="refreshError">That socket is no longer available.</mat-error>
      </div>
    </div>
  </form>
</div>
<ng-template #noSocket>
  <div class="center-container">
    <h2 class="local-center no-socket">Select a Socket</h2>
  </div>
</ng-template>
